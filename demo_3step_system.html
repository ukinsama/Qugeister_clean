<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Geister AI Demo - 3 Step Designer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        /* ã‚¹ãƒ†ãƒƒãƒ—ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .step-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .step-item {
            display: flex;
            align-items: center;
            margin: 0 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .step-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #ddd;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            margin-right: 15px;
            transition: all 0.3s ease;
        }

        .step-item.active .step-number {
            background: #667eea;
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.5);
        }

        .step-item.completed .step-number {
            background: #4CAF50;
        }

        .step-label {
            font-weight: 500;
            color: #666;
            font-size: 1.1em;
            transition: color 0.3s ease;
        }

        .step-item.active .step-label {
            color: #667eea;
            font-weight: bold;
        }

        .step-item.completed .step-label {
            color: #4CAF50;
        }

        /* ã‚¹ãƒ†ãƒƒãƒ—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .step-content {
            display: none;
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .step-content.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .step-title {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        /* Step 1: é‡å­æ¨å®šå™¨é¸æŠ */
        .estimator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .estimator-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
        }

        .estimator-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .estimator-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .estimator-icon {
            font-size: 3em;
            text-align: center;
            margin-bottom: 15px;
        }

        .estimator-title {
            font-size: 1.3em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
        }

        .estimator-specs {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 15px;
        }

        .estimator-description {
            font-size: 0.95em;
            line-height: 1.4;
        }

        /* Step 2: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š */
        .param-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 30px 0;
        }

        .param-section {
            background: #f8f9ff;
            padding: 25px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .param-section-title {
            font-size: 1.3em;
            color: #667eea;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .param-item {
            margin-bottom: 20px;
        }

        .param-label {
            display: block;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider {
            flex: 1;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }

        .value-display {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            min-width: 60px;
            text-align: center;
        }

        /* Step 3: ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ */
        .code-section {
            background: #f8f9ff;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .code-title {
            font-size: 1.3em;
            color: #667eea;
            font-weight: bold;
        }

        .copy-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .copy-button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .code-display {
            background: #2d3748;
            color: #e2e8f0;
            padding: 25px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .navigation-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .nav-button:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .nav-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .nav-button.next {
            background: #4CAF50;
        }

        .nav-button.next:hover {
            background: #45a049;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .param-grid {
                grid-template-columns: 1fr;
            }
            
            .step-navigation {
                flex-direction: column;
                gap: 20px;
            }
            
            .step-item {
                margin: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="header">
            <h1>ğŸ”® Quantum Geister AI Demo</h1>
            <p>é‡å­è¨ˆç®—ã«ã‚ˆã‚‹æ•µã‚³ãƒæ¨å®šã‚·ã‚¹ãƒ†ãƒ  - 3ã‚¹ãƒ†ãƒƒãƒ—ã§AIæ§‹ç¯‰</p>
        </div>

        <!-- ã‚¹ãƒ†ãƒƒãƒ—ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="step-navigation">
            <div class="step-item active" id="nav-step1" onclick="goToStep(1)">
                <div class="step-number">1</div>
                <div class="step-label">æ¨å®šå™¨é¸æŠ</div>
            </div>
            <div class="step-item" id="nav-step2" onclick="goToStep(2)">
                <div class="step-number">2</div>
                <div class="step-label">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š</div>
            </div>
            <div class="step-item" id="nav-step3" onclick="goToStep(3)">
                <div class="step-number">3</div>
                <div class="step-label">ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</div>
            </div>
        </div>

        <!-- Step 1: é‡å­æ¨å®šå™¨é¸æŠ -->
        <div class="step-content active" id="step1">
            <div class="step-title">âš›ï¸ é‡å­æ¨å®šå™¨ã‚’é¸æŠ</div>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">
                ã‚²ãƒ¼ãƒ ã®ç”¨é€”ã«å¿œã˜ã¦æœ€é©ãªæ•µã‚³ãƒæ¨å®šæ–¹å¼ã‚’é¸æŠã—ã¦ãã ã•ã„
            </p>
            
            <div class="estimator-grid">
                <div class="estimator-card" id="probabilistic-card" onclick="selectEstimator('probabilistic')">
                    <div class="estimator-icon">ğŸ²</div>
                    <div class="estimator-title">ç¢ºç‡çš„æ¨å®šå™¨</div>
                    <div class="estimator-specs">
                        <strong>ç²¾åº¦:</strong> 70-75% | <strong>é€Ÿåº¦:</strong> 10ms<br>
                        <strong>ãƒ¡ãƒ¢ãƒª:</strong> 50MB | <strong>è¤‡é›‘åº¦:</strong> ä½
                    </div>
                    <div class="estimator-description">
                        å„æ•µã‚³ãƒã‚’ç‹¬ç«‹ã—ã¦å–„ç‰ç¢ºç‡ã‚’æ¨å®šã€‚ã‚·ãƒ³ãƒ—ãƒ«ã§ç†è§£ã—ã‚„ã™ãã€åˆå¿ƒè€…å‘ã‘AIã‚„é«˜é€Ÿå¯¾æˆ¦ã«æœ€é©ã€‚
                    </div>
                </div>

                <div class="estimator-card" id="correlative-card" onclick="selectEstimator('correlative')">
                    <div class="estimator-icon">ğŸ”—</div>
                    <div class="estimator-title">ç›¸é–¢å‹æ¨å®šå™¨</div>
                    <div class="estimator-specs">
                        <strong>ç²¾åº¦:</strong> 80-85% | <strong>é€Ÿåº¦:</strong> 15ms<br>
                        <strong>ãƒ¡ãƒ¢ãƒª:</strong> 80MB | <strong>è¤‡é›‘åº¦:</strong> ä¸­
                    </div>
                    <div class="estimator-description">
                        ã‚³ãƒé–“ã®ç›¸é–¢ã‚’é‡å­ã‚¨ãƒ³ã‚¿ãƒ³ã‚°ãƒ«ãƒ¡ãƒ³ãƒˆã§è¡¨ç¾ã€‚ç›¸æ‰‹ã®é…ç½®æˆ¦ç•¥ã‚’æ¨å®šã—ã€å¤§ä¼šãƒ¬ãƒ™ãƒ«ã®å¯¾æˆ¦ã«å¯¾å¿œã€‚
                    </div>
                </div>

                <div class="estimator-card" id="temporal-card" onclick="selectEstimator('temporal')">
                    <div class="estimator-icon">â°</div>
                    <div class="estimator-title">æ™‚ç³»åˆ—æ¨å®šå™¨</div>
                    <div class="estimator-specs">
                        <strong>ç²¾åº¦:</strong> 85-90% | <strong>é€Ÿåº¦:</strong> 20ms<br>
                        <strong>ãƒ¡ãƒ¢ãƒª:</strong> 120MB | <strong>è¤‡é›‘åº¦:</strong> é«˜
                    </div>
                    <div class="estimator-description">
                        éå»ã®è¡Œå‹•å±¥æ­´ã‹ã‚‰å­¦ç¿’ã€‚ç›¸æ‰‹ã®ç™–ã‚„æˆ¦ç•¥ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã—ã€ãƒã‚¹ã‚¿ãƒ¼ãƒ¬ãƒ™ãƒ«ã®å¯¾æˆ¦ã«å¯¾å¿œã€‚
                    </div>
                </div>

                <div class="estimator-card" id="ensemble-card" onclick="selectEstimator('ensemble')">
                    <div class="estimator-icon">ğŸ­</div>
                    <div class="estimator-title">ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ¨å®šå™¨</div>
                    <div class="estimator-specs">
                        <strong>ç²¾åº¦:</strong> 90-95% | <strong>é€Ÿåº¦:</strong> 35ms<br>
                        <strong>ãƒ¡ãƒ¢ãƒª:</strong> 200MB | <strong>è¤‡é›‘åº¦:</strong> æœ€é«˜
                    </div>
                    <div class="estimator-description">
                        è¤‡æ•°æ¨å®šå™¨ã‚’çµ±åˆã—ãŸæœ€é«˜ç²¾åº¦ç‰ˆã€‚ç ”ç©¶ç”¨é€”ã‚„æœ€é‡è¦å¯¾æˆ¦ã§ã®ä½¿ç”¨ã‚’æƒ³å®šã€‚è¨ˆç®—ã‚³ã‚¹ãƒˆãŒé«˜ã„ã€‚
                    </div>
                </div>
            </div>

            <div class="navigation-buttons">
                <button class="nav-button" disabled>â† å‰ã¸</button>
                <button class="nav-button next" onclick="nextStep()" id="step1-next" disabled>æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- Step 2: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š -->
        <div class="step-content" id="step2">
            <div class="step-title">âš™ï¸ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š</div>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">
                é¸æŠã—ãŸæ¨å®šå™¨ã®å‹•ä½œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã—ã¦ãã ã•ã„
            </p>

            <div class="param-grid">
                <!-- é‡å­å›è·¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ -->
                <div class="param-section">
                    <div class="param-section-title">
                        <span>âš›ï¸</span>é‡å­å›è·¯è¨­å®š
                    </div>
                    
                    <div class="param-item">
                        <label class="param-label">é‡å­ãƒ“ãƒƒãƒˆæ•° (n_qubits)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="qubitsSlider" 
                                   min="4" max="8" value="4" 
                                   oninput="updateQuantumParams()">
                            <div class="value-display" id="qubitsValue">4</div>
                        </div>
                    </div>

                    <div class="param-item">
                        <label class="param-label">ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•° (n_layers)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="layersSlider" 
                                   min="2" max="5" value="3" 
                                   oninput="updateQuantumParams()">
                            <div class="value-display" id="layersValue">3</div>
                        </div>
                    </div>

                    <div class="param-item" id="memoryParam" style="display: none;">
                        <label class="param-label">ãƒ¡ãƒ¢ãƒªé•· (æ™‚ç³»åˆ—ç”¨)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="memorySlider" 
                                   min="3" max="10" value="5" 
                                   oninput="updateQuantumParams()">
                            <div class="value-display" id="memoryValue">5</div>
                        </div>
                    </div>
                </div>

                <!-- å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ -->
                <div class="param-section">
                    <div class="param-section-title">
                        <span>ğŸ“š</span>å­¦ç¿’è¨­å®š
                    </div>
                    
                    <div class="param-item">
                        <label class="param-label">å­¦ç¿’ç‡ (learning_rate)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="lrSlider" 
                                   min="-4" max="-2" value="-3" step="0.1" 
                                   oninput="updateLearningParams()">
                            <div class="value-display" id="lrValue">0.001</div>
                        </div>
                    </div>

                    <div class="param-item">
                        <label class="param-label">æ¢ç´¢ç‡ (epsilon)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="epsilonSlider" 
                                   min="0.05" max="0.3" value="0.1" step="0.01" 
                                   oninput="updateLearningParams()">
                            <div class="value-display" id="epsilonValue">0.1</div>
                        </div>
                    </div>

                    <div class="param-item">
                        <label class="param-label">æ¢ç´¢æ¸›è¡°ç‡ (epsilon_decay)</label>
                        <div class="slider-container">
                            <input type="range" class="slider" id="decaySlider" 
                                   min="0.990" max="0.999" value="0.995" step="0.001" 
                                   oninput="updateLearningParams()">
                            <div class="value-display" id="decayValue">0.995</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¬æ˜ -->
            <div style="background: #f0f4ff; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4 style="color: #667eea; margin-bottom: 10px;">ğŸ“ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜</h4>
                <div id="paramExplanation">æ¨å®šå™¨ã‚’é¸æŠã™ã‚‹ã¨ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è©³ç´°èª¬æ˜ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</div>
            </div>

            <div class="navigation-buttons">
                <button class="nav-button" onclick="prevStep()">â† å‰ã¸</button>
                <button class="nav-button next" onclick="nextStep()">æ¬¡ã¸ â†’</button>
            </div>
        </div>

        <!-- Step 3: ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ -->
        <div class="step-content" id="step3">
            <div class="step-title">ğŸš€ AIæ§‹ç¯‰ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</div>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">
                è¨­å®šã«åŸºã¥ã„ã¦Pythonã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™
            </p>

            <!-- è¨­å®šã‚µãƒãƒªãƒ¼ -->
            <div style="background: #f0f4ff; padding: 25px; border-radius: 15px; margin-bottom: 30px;">
                <h4 style="color: #667eea; margin-bottom: 15px;">ğŸ“‹ æ§‹æˆã‚µãƒãƒªãƒ¼</h4>
                <div id="configSummary">
                    è¨­å®šã‚’å®Œäº†ã™ã‚‹ã¨ã€AIæ§‹æˆã®è©³ç´°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
                </div>
            </div>

            <!-- ã‚³ãƒ¼ãƒ‰å‡ºåŠ› -->
            <div class="code-section">
                <div class="code-header">
                    <div class="code-title">ğŸ“ ç”Ÿæˆã•ã‚ŒãŸPythonã‚³ãƒ¼ãƒ‰</div>
                    <button class="copy-button" onclick="copyCode()" id="copyBtn" disabled>ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                </div>
                <div class="code-display" id="generatedCode">
                    ã“ã“ã«ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™...
                </div>
            </div>

            <div class="navigation-buttons">
                <button class="nav-button" onclick="prevStep()">â† å‰ã¸</button>
                <button class="nav-button next" onclick="generateFinalCode()" style="background: #4CAF50;">ğŸš€ æœ€çµ‚ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</button>
            </div>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentStep = 1;
        let selectedEstimator = null;
        let config = {
            estimator_type: null,
            n_qubits: 4,
            n_layers: 3,
            memory_length: 5,
            learning_rate: 0.001,
            epsilon: 0.1,
            epsilon_decay: 0.995
        };

        // ã‚¹ãƒ†ãƒƒãƒ—åˆ‡ã‚Šæ›¿ãˆ
        function goToStep(step) {
            if (step < currentStep || (step === currentStep + 1 && validateCurrentStep())) {
                // ç¾åœ¨ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤º
                document.getElementById(`step${currentStep}`).classList.remove('active');
                document.getElementById(`nav-step${currentStep}`).classList.remove('active');
                
                // æ–°ã—ã„ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º
                currentStep = step;
                document.getElementById(`step${currentStep}`).classList.add('active');
                document.getElementById(`nav-step${currentStep}`).classList.add('active');
                
                // å®Œäº†ã—ãŸã‚¹ãƒ†ãƒƒãƒ—ã‚’ãƒãƒ¼ã‚¯
                for (let i = 1; i < currentStep; i++) {
                    document.getElementById(`nav-step${i}`).classList.add('completed');
                }
                
                // ã‚¹ãƒ†ãƒƒãƒ—å›ºæœ‰ã®å‡¦ç†
                if (currentStep === 2) {
                    updateParameterVisibility();
                } else if (currentStep === 3) {
                    updateConfigSummary();
                    generateCode();
                }
            }
        }

        function nextStep() {
            if (validateCurrentStep()) {
                goToStep(currentStep + 1);
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                goToStep(currentStep - 1);
            }
        }

        function validateCurrentStep() {
            if (currentStep === 1) {
                return selectedEstimator !== null;
            }
            return true;
        }

        // æ¨å®šå™¨é¸æŠ
        function selectEstimator(estimatorType) {
            // å‰ã®é¸æŠã‚’ãƒªã‚»ãƒƒãƒˆ
            document.querySelectorAll('.estimator-card').forEach(card => {
                card.classList.remove('selected');
            });
            
            // æ–°ã—ã„é¸æŠã‚’ãƒãƒ¼ã‚¯
            document.getElementById(`${estimatorType}-card`).classList.add('selected');
            selectedEstimator = estimatorType;
            config.estimator_type = estimatorType;
            
            // æ¬¡ã¸ãƒœã‚¿ãƒ³ã‚’æœ‰åŠ¹åŒ–
            document.getElementById('step1-next').disabled = false;
            
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®š
            setDefaultParams(estimatorType);
        }

        function setDefaultParams(estimatorType) {
            switch(estimatorType) {
                case 'probabilistic':
                    config.n_qubits = 4;
                    config.n_layers = 3;
                    break;
                case 'correlative':
                    config.n_qubits = 6;
                    config.n_layers = 4;
                    break;
                case 'temporal':
                    config.n_qubits = 6;
                    config.n_layers = 4;
                    config.memory_length = 8;
                    break;
                case 'ensemble':
                    config.n_qubits = 8;
                    config.n_layers = 5;
                    break;
            }
            
            // UIã‚’æ›´æ–°
            if (currentStep === 2) {
                updateParameterSliders();
            }
        }

        function updateParameterVisibility() {
            const memoryParam = document.getElementById('memoryParam');
            if (selectedEstimator === 'temporal' || selectedEstimator === 'ensemble') {
                memoryParam.style.display = 'block';
            } else {
                memoryParam.style.display = 'none';
            }
            
            updateParameterSliders();
            updateParamExplanation();
        }

        function updateParameterSliders() {
            document.getElementById('qubitsSlider').value = config.n_qubits;
            document.getElementById('qubitsValue').textContent = config.n_qubits;
            
            document.getElementById('layersSlider').value = config.n_layers;
            document.getElementById('layersValue').textContent = config.n_layers;
            
            document.getElementById('memorySlider').value = config.memory_length;
            document.getElementById('memoryValue').textContent = config.memory_length;
            
            document.getElementById('lrSlider').value = Math.log10(config.learning_rate);
            document.getElementById('lrValue').textContent = config.learning_rate;
            
            document.getElementById('epsilonSlider').value = config.epsilon;
            document.getElementById('epsilonValue').textContent = config.epsilon;
            
            document.getElementById('decaySlider').value = config.epsilon_decay;
            document.getElementById('decayValue').textContent = config.epsilon_decay;
        }

        function updateQuantumParams() {
            config.n_qubits = parseInt(document.getElementById('qubitsSlider').value);
            config.n_layers = parseInt(document.getElementById('layersSlider').value);
            config.memory_length = parseInt(document.getElementById('memorySlider').value);
            
            document.getElementById('qubitsValue').textContent = config.n_qubits;
            document.getElementById('layersValue').textContent = config.n_layers;
            document.getElementById('memoryValue').textContent = config.memory_length;
        }

        function updateLearningParams() {
            config.learning_rate = Math.pow(10, parseFloat(document.getElementById('lrSlider').value));
            config.epsilon = parseFloat(document.getElementById('epsilonSlider').value);
            config.epsilon_decay = parseFloat(document.getElementById('decaySlider').value);
            
            document.getElementById('lrValue').textContent = config.learning_rate.toFixed(4);
            document.getElementById('epsilonValue').textContent = config.epsilon.toFixed(2);
            document.getElementById('decayValue').textContent = config.epsilon_decay.toFixed(3);
        }

        function updateParamExplanation() {
            const explanations = {
                'probabilistic': `
                    <strong>ç¢ºç‡çš„æ¨å®šå™¨ã®ç‰¹å¾´:</strong><br>
                    â€¢ é‡å­ãƒ“ãƒƒãƒˆæ•°: å„æ•µã‚³ãƒã®ç‰¹å¾´æ•°ï¼ˆä½ç½®ã€ç§»å‹•ã€å‘¨è¾ºã€æˆ¦è¡“ï¼‰<br>
                    â€¢ ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°: é‡å­å›è·¯ã®æ·±ã•ï¼ˆæ·±ã„ã»ã©è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ï¼‰<br>
                    â€¢ è¨ˆç®—é‡: O(n_qubits Ã— n_layers) - è»½é‡ã§é«˜é€Ÿ
                `,
                'correlative': `
                    <strong>ç›¸é–¢å‹æ¨å®šå™¨ã®ç‰¹å¾´:</strong><br>
                    â€¢ é‡å­ãƒ“ãƒƒãƒˆæ•°: å…¨æ•µã‚³ãƒã‚’åŒæ™‚å‡¦ç†ï¼ˆã‚¨ãƒ³ã‚¿ãƒ³ã‚°ãƒ«ãƒ¡ãƒ³ãƒˆç”¨ï¼‰<br>
                    â€¢ ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°: ç›¸é–¢å­¦ç¿’ã®æ·±ã•ï¼ˆã‚³ãƒé–“é–¢ä¿‚ã®è¤‡é›‘ã•ï¼‰<br>
                    â€¢ è¨ˆç®—é‡: O(n_qubitsÂ² Ã— n_layers) - ä¸­ç¨‹åº¦ã®è² è·
                `,
                'temporal': `
                    <strong>æ™‚ç³»åˆ—æ¨å®šå™¨ã®ç‰¹å¾´:</strong><br>
                    â€¢ ãƒ¡ãƒ¢ãƒªé•·: éå»ä½•æ‰‹åˆ†ã‚’è¨˜æ†¶ã™ã‚‹ã‹ï¼ˆé•·ã„ã»ã©ç²¾åº¦å‘ä¸Šï¼‰<br>
                    â€¢ ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°: æ™‚ç³»åˆ—ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­¦ç¿’æ·±åº¦<br>
                    â€¢ è¨ˆç®—é‡: O(memory_length Ã— n_qubits Ã— n_layers) - ã‚„ã‚„é‡ã„
                `,
                'ensemble': `
                    <strong>ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ¨å®šå™¨ã®ç‰¹å¾´:</strong><br>
                    â€¢ å…¨æ¨å®šå™¨ã‚’çµ±åˆ: ç¢ºç‡çš„ + ç›¸é–¢å‹ + æ™‚ç³»åˆ—<br>
                    â€¢ æœ€é«˜ã®ç²¾åº¦ã¨ä¿¡é ¼æ€§ã‚’å®Ÿç¾<br>
                    â€¢ è¨ˆç®—é‡: ä»–ã®æ‰‹æ³•ã®åˆè¨ˆ - æœ€ã‚‚é‡ã„
                `
            };
            
            document.getElementById('paramExplanation').innerHTML = 
                explanations[selectedEstimator] || 'ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜ãŒã‚ã‚Šã¾ã›ã‚“ã€‚';
        }

        function updateConfigSummary() {
            const estimatorNames = {
                'probabilistic': 'ç¢ºç‡çš„æ¨å®šå™¨',
                'correlative': 'ç›¸é–¢å‹æ¨å®šå™¨', 
                'temporal': 'æ™‚ç³»åˆ—æ¨å®šå™¨',
                'ensemble': 'ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ¨å®šå™¨'
            };
            
            const summary = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <strong>ğŸ”® æ¨å®šå™¨ã‚¿ã‚¤ãƒ—:</strong> ${estimatorNames[selectedEstimator]}<br>
                        <strong>âš›ï¸ é‡å­ãƒ“ãƒƒãƒˆæ•°:</strong> ${config.n_qubits}<br>
                        <strong>ğŸ“š ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°:</strong> ${config.n_layers}<br>
                        ${selectedEstimator === 'temporal' || selectedEstimator === 'ensemble' ? 
                          `<strong>â° ãƒ¡ãƒ¢ãƒªé•·:</strong> ${config.memory_length}<br>` : ''}
                    </div>
                    <div>
                        <strong>ğŸ“ å­¦ç¿’ç‡:</strong> ${config.learning_rate}<br>
                        <strong>ğŸ² æ¢ç´¢ç‡:</strong> ${config.epsilon}<br>
                        <strong>ğŸ“‰ æ¸›è¡°ç‡:</strong> ${config.epsilon_decay}<br>
                    </div>
                </div>
            `;
            
            document.getElementById('configSummary').innerHTML = summary;
        }

        function generateCode() {
            const code = `#!/usr/bin/env python3
"""
${getEstimatorDescription()}
è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸQuantum Geister AIã‚³ãƒ¼ãƒ‰
"""

import torch
import torch.nn as nn
import pennylane as qml
import numpy as np

class ${getEstimatorClassName()}(nn.Module):
    def __init__(self):
        super().__init__()
        
        # é‡å­ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.n_qubits = ${config.n_qubits}
        self.n_layers = ${config.n_layers}
        ${selectedEstimator === 'temporal' || selectedEstimator === 'ensemble' ? 
          `self.memory_length = ${config.memory_length}` : ''}
        
        # é‡å­ãƒ‡ãƒã‚¤ã‚¹
        self.dev = qml.device('default.qubit', wires=self.n_qubits)
        
        # å­¦ç¿’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.learning_rate = ${config.learning_rate}
        self.epsilon = ${config.epsilon}
        self.epsilon_decay = ${config.epsilon_decay}
        
        ${getEstimatorSpecificCode()}
        
    def forward(self, state_vector):
        """
        æ•µã‚³ãƒæ¨å®šã®å®Ÿè¡Œ
        
        Args:
            state_vector: [batch, 252] çŠ¶æ…‹ãƒ™ã‚¯ãƒˆãƒ«
        Returns:
            opponent_features: [batch, ${getOutputDimension()}] æ•µæ¨å®šçµæœ
        """
        ${getForwardCode()}

${getQuantumCircuitCode()}

# ä½¿ç”¨ä¾‹
if __name__ == "__main__":
    print("ğŸ”® ${getEstimatorDescription()}")
    print("=" * 50)
    
    # ãƒ¢ãƒ‡ãƒ«åˆæœŸåŒ–
    model = ${getEstimatorClassName()}()
    print(f"âœ… ãƒ¢ãƒ‡ãƒ«ä½œæˆå®Œäº†")
    print(f"   å‡ºåŠ›æ¬¡å…ƒ: ${getOutputDimension()}")
    print(f"   é‡å­ãƒ“ãƒƒãƒˆ: {config.n_qubits}")
    print(f"   ãƒ¬ã‚¤ãƒ¤ãƒ¼æ•°: {config.n_layers}")
    
    # ã‚µãƒ³ãƒ—ãƒ«æ¨å®š
    sample_state = torch.randn(1, 252)
    with torch.no_grad():
        result = model(sample_state)
        print(f"   æ¨å®šçµæœshape: {result.shape}")
    
    print("ğŸš€ Quantum Geister AI æº–å‚™å®Œäº†!")`;
            
            document.getElementById('generatedCode').textContent = code;
            document.getElementById('copyBtn').disabled = false;
        }

        function getEstimatorDescription() {
            const descriptions = {
                'probabilistic': 'Probabilistic Quantum Estimator - ç¢ºç‡çš„é‡å­æ¨å®šå™¨',
                'correlative': 'Correlative Quantum Estimator - ç›¸é–¢å‹é‡å­æ¨å®šå™¨',
                'temporal': 'Temporal Quantum Estimator - æ™‚ç³»åˆ—é‡å­æ¨å®šå™¨',
                'ensemble': 'Ensemble Quantum Estimator - ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«é‡å­æ¨å®šå™¨'
            };
            return descriptions[selectedEstimator];
        }

        function getEstimatorClassName() {
            const classNames = {
                'probabilistic': 'ProbabilisticQuantumEstimator',
                'correlative': 'CorrelativeQuantumEstimator',
                'temporal': 'TemporalQuantumEstimator',
                'ensemble': 'EnsembleQuantumEstimator'
            };
            return classNames[selectedEstimator];
        }

        function getOutputDimension() {
            const dimensions = {
                'probabilistic': 16,  // 8ç¢ºç‡ + 8ä¿¡é ¼åº¦
                'correlative': 24,    // 8ç¢ºç‡ + 16ç›¸é–¢
                'temporal': 20,       // 8ç¢ºç‡ + 12æ™‚ç³»åˆ—ç‰¹å¾´
                'ensemble': 32        // å…¨ç‰¹å¾´çµ±åˆ
            };
            return dimensions[selectedEstimator];
        }

        function getEstimatorSpecificCode() {
            switch(selectedEstimator) {
                case 'probabilistic':
                    return `        # 8å€‹ã®æ•µã‚³ãƒç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.weights = nn.Parameter(
            torch.randn(8, self.n_layers, self.n_qubits, 2) * 0.1
        )`;
                case 'correlative':
                    return `        # å…¨æ•µã‚³ãƒç›¸é–¢ç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.weights = nn.Parameter(
            torch.randn(self.n_layers, self.n_qubits, self.n_qubits) * 0.1
        )`;
                case 'temporal':
                    return `        # æ™‚ç³»åˆ—è¨˜æ†¶ãƒãƒƒãƒ•ã‚¡
        self.memory_buffer = torch.zeros(self.memory_length, 8, 4)
        self.weights = nn.Parameter(
            torch.randn(self.n_layers + self.memory_length, self.n_qubits, 2) * 0.1
        )`;
                case 'ensemble':
                    return `        # è¤‡æ•°æ¨å®šå™¨ã®çµ±åˆ
        self.prob_estimator = ProbabilisticQuantumEstimator()
        self.corr_estimator = CorrelativeQuantumEstimator()
        self.temp_estimator = TemporalQuantumEstimator()
        self.fusion_layer = nn.Linear(60, 32)`;
            }
        }

        function getForwardCode() {
            switch(selectedEstimator) {
                case 'probabilistic':
                    return `        batch_size = state_vector.size(0)
        probabilities = torch.zeros(batch_size, 8)
        confidences = torch.zeros(batch_size, 8)
        
        # å„æ•µã‚³ãƒã‚’ç‹¬ç«‹æ¨å®š
        for i in range(8):
            prob, conf = self.estimate_single_piece(state_vector, i)
            probabilities[:, i] = prob
            confidences[:, i] = conf
        
        return torch.cat([probabilities, confidences], dim=1)`;
                default:
                    return `        # ${selectedEstimator}æ¨å®šå™¨ã®å®Ÿè£…
        return self.quantum_estimation_circuit(state_vector)`;
            }
        }

        function getQuantumCircuitCode() {
            return `
    @qml.qnode(device, interface="torch")
    def quantum_circuit(self, features, weights):
        """é‡å­å›è·¯ã«ã‚ˆã‚‹æ¨å®š"""
        # ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å±¤
        for i in range(self.n_qubits):
            qml.RY(features[i] * np.pi, wires=i)
        
        # å¤‰åˆ†é‡å­å›è·¯
        for layer in range(self.n_layers):
            # ã‚¨ãƒ³ã‚¿ãƒ³ã‚°ãƒ«ãƒ¡ãƒ³ãƒˆ
            for i in range(self.n_qubits - 1):
                qml.CNOT(wires=[i, i + 1])
            
            # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–å›è»¢
            for i in range(self.n_qubits):
                qml.RY(weights[layer, i, 0], wires=i)
                qml.RZ(weights[layer, i, 1], wires=i)
        
        # æ¸¬å®š
        return [qml.expval(qml.PauliZ(i)) for i in range(self.n_qubits)]`;
        }

        function copyCode() {
            const codeElement = document.getElementById('generatedCode');
            const textArea = document.createElement('textarea');
            textArea.value = codeElement.textContent;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            const copyBtn = document.getElementById('copyBtn');
            const originalText = copyBtn.textContent;
            copyBtn.textContent = 'âœ… ã‚³ãƒ”ãƒ¼å®Œäº†!';
            copyBtn.style.background = '#4CAF50';
            
            setTimeout(() => {
                copyBtn.textContent = originalText;
                copyBtn.style.background = '#667eea';
            }, 2000);
        }

        function generateFinalCode() {
            generateCode();
            alert('ğŸš€ Quantum Geister AI ã®æ§‹ç¯‰ãŒå®Œäº†ã—ã¾ã—ãŸ!\n\nã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã€Pythonç’°å¢ƒã§å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚\n\nå¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª:\n- torch\n- pennylane\n- numpy');
        }

        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateParamExplanation();
        });
    </script>
</body>
</html>